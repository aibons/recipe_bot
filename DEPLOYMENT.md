# Инструкции по развертыванию Recipe Bot

## Исправленные проблемы

✅ **Улучшена загрузка видео** - добавлены правильные User-Agent и headers для обхода блокировок  
✅ **Лучшая обработка ошибок** - информативные сообщения для разных типов ошибок  
✅ **Поддержка cookies через переменные окружения** - не нужно загружать файлы на сервер  
✅ **Улучшенная поддержка URL** - более точная проверка поддерживаемых форматов  
✅ **Подробное логирование** - для диагностики проблем  

## Переменные окружения

### Обязательные
```
TELEGRAM_TOKEN=your_bot_token_here
OPENAI_API_KEY=your_openai_api_key_here
WEBHOOK_URL=https://your-app-name.onrender.com/
```

### Опциональные
```
OWNER_ID=248610561
FREE_LIMIT=6
PORT=8080
```

### Cookies (опционально, для обхода ограничений)

Вместо загрузки файлов cookies на сервер, можно использовать переменные окружения:

```
IG_COOKIES_CONTENT=# Netscape HTTP Cookie File
# Содержимое cookies_instagram.txt

TT_COOKIES_CONTENT=# Netscape HTTP Cookie File  
# Содержимое cookies_tiktok.txt

YT_COOKIES_CONTENT=# Netscape HTTP Cookie File
# Содержимое cookies_youtube.txt
```

## Как получить cookies

### Instagram
1. Откройте Instagram в браузере и войдите в аккаунт
2. Установите расширение для экспорта cookies (например, "Get cookies.txt")
3. Экспортируйте cookies для instagram.com
4. Скопируйте содержимое в переменную `IG_COOKIES_CONTENT`

### TikTok
1. Откройте TikTok в браузере и войдите в аккаунт
2. Экспортируйте cookies для tiktok.com
3. Скопируйте содержимое в переменную `TT_COOKIES_CONTENT`

### YouTube
1. Откройте YouTube в браузере и войдите в аккаунт
2. Экспортируйте cookies для youtube.com
3. Скопируйте содержимое в переменную `YT_COOKIES_CONTENT`

## Развертывание на Render

1. Клонируйте репозиторий на Render
2. Установите переменные окружения в настройках сервиса
3. Убедитесь, что `WEBHOOK_URL` соответствует URL вашего сервиса
4. Деплойте сервис

## Поддерживаемые форматы URL

### Instagram
- `instagram.com/reel/xxx` - Reels
- `instagram.com/p/xxx` - Посты с видео
- `instagram.com/tv/xxx` - IGTV

### TikTok
- `tiktok.com/@username/video/xxx` - Обычные видео
- `vm.tiktok.com/xxx` - Короткие ссылки
- `vt.tiktok.com/xxx` - Короткие ссылки

### YouTube
- `youtube.com/shorts/xxx` - YouTube Shorts
- `youtu.be/xxx` - Короткие ссылки
- `youtube.com/watch?v=xxx` - Обычные видео

## Диагностика проблем

Если видео не загружается:

1. **Проверьте логи** - в Render смотрите логи приложения
2. **Убедитесь в правильности URL** - бот проверит формат и сообщит об ошибке
3. **Попробуйте другое видео** - возможно, конкретное видео приватное
4. **Обновите cookies** - если используете аутентификацию

## Типичные ошибки

### "Video is private or requires authentication"
- Видео приватное или требует входа
- Добавьте cookies в переменные окружения

### "Video is not available"
- Видео удалено или не существует
- Попробуйте другую ссылку

### "Video is geo-blocked"
- Видео недоступно в вашем регионе
- Возможно, поможет VPN или другая ссылка

### "Network error"
- Проблемы с интернет-соединением
- Повторите попытку позже

## Лимиты

- **Размер видео**: максимум 50MB (ограничение Telegram)
- **Формат**: предпочтительно MP4, максимальное разрешение 720p
- **Продолжительность**: без ограничений, но рекомендуется короткие видео

## Логирование

Бот ведет подробные логи процесса загрузки:
- Извлечение информации о видео
- Процесс загрузки
- Размер и формат файла
- Ошибки и их типы

Используйте логи для диагностики проблем.